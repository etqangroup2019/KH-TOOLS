#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
ููู ุชุดุบูู ุงููุธุงู ุงููุญุงุณุจู ุงูุดุงูู
ูููู ุงุณุชุฎุฏุงู ูุฐุง ุงูููู ูุชุดุบูู ูุงุฎุชุจุงุฑ ุงููุธุงู ุงููุญุงุณุจู
"""

import sys
import os
from datetime import datetime

# ุฅุถุงูุฉ ุงููุณุงุฑ ุงูุญุงูู ููุณุงุฑ Python
sys.path.append(os.path.dirname(os.path.abspath(__file__)))

# ุงุณุชูุฑุงุฏ ุงููุธุงู ุงููุญุงุณุจู
from ูุธุงู_ุงููุญุงุณุจุฉ_ุงูุดุงูู import ูุธุงู_ุงููุญุงุณุจุฉ_ุงูุดุงูู

def ุนุฑุถ_ุงููุงุฆูุฉ_ุงูุฑุฆูุณูุฉ():
    """ุนุฑุถ ุงููุงุฆูุฉ ุงูุฑุฆูุณูุฉ ูููุธุงู"""
    print("\n" + "="*60)
    print("๐ข ููุธููุฉ ุงููููุฏุณ v3 - ุงููุธุงู ุงููุญุงุณุจู ุงูุดุงูู")
    print("="*60)
    print("1๏ธโฃ  ุฅูุดุงุก ุงููุธุงู ุงููุงูู")
    print("2๏ธโฃ  ุนุฑุถ ุฅุญุตุงุฆูุงุช ุงููุธุงู")
    print("3๏ธโฃ  ุฅูุดุงุก ููุฏ ูุญุงุณุจู ุชุฌุฑูุจู")
    print("4๏ธโฃ  ุฅูุดุงุก ูุณุฎุฉ ุงุญุชูุงุทูุฉ")
    print("5๏ธโฃ  ุงุฎุชุจุงุฑ ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช")
    print("6๏ธโฃ  ุนุฑุถ ุงูุฌุฏุงูู ุงูููุดุฃุฉ")
    print("7๏ธโฃ  ุญุณุงุจ ุฑุตูุฏ ุญุณุงุจ")
    print("8๏ธโฃ  ุฅุถุงูุฉ ุจูุงูุงุช ุชุฌุฑูุจูุฉ")
    print("0๏ธโฃ  ุฎุฑูุฌ")
    print("="*60)

def ุงูุดุงุก_ุงููุธุงู_ุงููุงูู(ูุธุงู):
    """ุฅูุดุงุก ุงููุธุงู ุงููุญุงุณุจู ุงููุงูู"""
    print("\n๐ ุจุฏุก ุฅูุดุงุก ุงููุธุงู ุงููุญุงุณุจู ุงูุดุงูู...")
    
    start_time = datetime.now()
    
    if ูุธุงู.ุงูุดุงุก_ุงููุธุงู_ุงููุงูู():
        end_time = datetime.now()
        duration = (end_time - start_time).total_seconds()
        
        print(f"โ ุชู ุฅูุดุงุก ุงููุธุงู ุจูุฌุงุญ ูู {duration:.2f} ุซุงููุฉ!")
        print(f"๐ ุนุฏุฏ ุงูุฌุฏุงูู ุงูููุดุฃุฉ: {len(ูุธุงู.tables_created)}")
        print(f"๐ ุนุฏุฏ ุงูููุงุฑุณ ุงูููุดุฃุฉ: {len(ูุธุงู.indexes_created)}")
        print(f"โก ุนุฏุฏ ุงููุดุบูุงุช ุงูููุดุฃุฉ: {len(ูุธุงู.triggers_created)}")
        
        # ุนุฑุถ ูุงุฆูุฉ ุงูุฌุฏุงูู
        print("\n๐ ุงูุฌุฏุงูู ุงูููุดุฃุฉ:")
        for i, table in enumerate(sorted(ูุธุงู.tables_created), 1):
            print(f"   {i:2d}. {table}")
            
    else:
        print("โ ูุดู ูู ุฅูุดุงุก ุงููุธุงู")

def ุนุฑุถ_ุงุญุตุงุฆูุงุช_ุงููุธุงู(ูุธุงู):
    """ุนุฑุถ ุฅุญุตุงุฆูุงุช ุงููุธุงู"""
    print("\n๐ ุฌุงุฑู ุฌูุน ุฅุญุตุงุฆูุงุช ุงููุธุงู...")
    
    stats = ูุธุงู.ุงุญุตุงุฆูุงุช_ุงููุธุงู()
    
    if 'ุฎุทุฃ' in stats:
        print(f"โ ุฎุทุฃ ูู ุฌูุน ุงูุฅุญุตุงุฆูุงุช: {stats['ุฎุทุฃ']}")
        return
    
    print("\n๐ ุฅุญุตุงุฆูุงุช ุงููุธุงู:")
    print("-" * 40)
    
    for section, data in stats.items():
        if section == 'ุชุงุฑูุฎ_ุงูุฅุญุตุงุฆูุงุช':
            continue
            
        print(f"\n๐น {section}:")
        if isinstance(data, dict):
            for key, value in data.items():
                if isinstance(value, (int, float)):
                    if isinstance(value, float):
                        print(f"   {key}: {value:,.2f}")
                    else:
                        print(f"   {key}: {value:,}")
                elif isinstance(value, list):
                    print(f"   {key}: {len(value)} ุนูุตุฑ")
                else:
                    print(f"   {key}: {value}")
        else:
            print(f"   {data}")
    
    print(f"\nโฐ ุชุงุฑูุฎ ุงูุฅุญุตุงุฆูุงุช: {stats.get('ุชุงุฑูุฎ_ุงูุฅุญุตุงุฆูุงุช', 'ุบูุฑ ูุญุฏุฏ')}")

def ุงูุดุงุก_ููุฏ_ุชุฌุฑูุจู(ูุธุงู):
    """ุฅูุดุงุก ููุฏ ูุญุงุณุจู ุชุฌุฑูุจู"""
    print("\n๐ฐ ุฅูุดุงุก ููุฏ ูุญุงุณุจู ุชุฌุฑูุจู...")
    
    # ุงูุชุญูู ูู ูุฌูุฏ ุญุณุงุจุงุช
    accounts = ูุธุงู.ุชุญููู_ุจูุงูุงุช('ุดุฌุฑุฉ_ุงูุญุณุงุจุงุช', 'id, ุงุณู_ุงูุญุณุงุจ', 'ููุจู_ูููุฏ = TRUE', limit=5)
    
    if len(accounts) < 2:
        print("โ ูุง ุชูุฌุฏ ุญุณุงุจุงุช ูุงููุฉ ูุฅูุดุงุก ููุฏ ุชุฌุฑูุจู")
        print("๐ก ูุฑุฌู ุฅูุดุงุก ุงููุธุงู ุงููุงูู ุฃููุงู")
        return
    
    # ุฅูุดุงุก ููุฏ ุชุฌุฑูุจู
    ุชูุงุตูู_ุงูููุฏ = [
        {
            'ูุนุฑู_ุงูุญุณุงุจ': accounts[0]['id'],
            'ุงูุจูุงู': f"ูู {accounts[0]['ุงุณู_ุงูุญุณุงุจ']}",
            'ูุฏูู': 1000.00,
            'ุฏุงุฆู': 0.00
        },
        {
            'ูุนุฑู_ุงูุญุณุงุจ': accounts[1]['id'],
            'ุงูุจูุงู': f"ุฅูู {accounts[1]['ุงุณู_ุงูุญุณุงุจ']}",
            'ูุฏูู': 0.00,
            'ุฏุงุฆู': 1000.00
        }
    ]
    
    ูุนุฑู_ุงูููุฏ = ูุธุงู.ุงูุดุงุก_ููุฏ_ูุญุงุณุจู(
        "ููุฏ ุชุฌุฑูุจู - ุงุฎุชุจุงุฑ ุงููุธุงู",
        ุชูุงุตูู_ุงูููุฏ,
        'ูููู'
    )
    
    if ูุนุฑู_ุงูููุฏ:
        print(f"โ ุชู ุฅูุดุงุก ุงูููุฏ ุงูุชุฌุฑูุจู ุจูุฌุงุญ - ุงููุนุฑู: {ูุนุฑู_ุงูููุฏ}")
        
        # ุนุฑุถ ุชูุงุตูู ุงูููุฏ
        ููุฏ_details = ูุธุงู.ุชุญููู_ุจูุงูุงุช(
            'ุงููููุฏ_ุงููุญุงุณุจูุฉ', 
            '*', 
            'id = %s', 
            (ูุนุฑู_ุงูููุฏ,)
        )
        
        if ููุฏ_details:
            ููุฏ = ููุฏ_details[0]
            print(f"   ุฑูู ุงูููุฏ: {ููุฏ['ุฑูู_ุงูููุฏ']}")
            print(f"   ุชุงุฑูุฎ ุงูููุฏ: {ููุฏ['ุชุงุฑูุฎ_ุงูููุฏ']}")
            print(f"   ุฅุฌูุงูู ุงููุฏูู: {ููุฏ['ุฅุฌูุงูู_ุงููุฏูู']:,.2f}")
            print(f"   ุฅุฌูุงูู ุงูุฏุงุฆู: {ููุฏ['ุฅุฌูุงูู_ุงูุฏุงุฆู']:,.2f}")
            print(f"   ูุชูุงุฒู: {'ูุนู' if ููุฏ['ูุชูุงุฒู'] else 'ูุง'}")
    else:
        print("โ ูุดู ูู ุฅูุดุงุก ุงูููุฏ ุงูุชุฌุฑูุจู")

def ุงูุดุงุก_ูุณุฎุฉ_ุงุญุชูุงุทูุฉ(ูุธุงู):
    """ุฅูุดุงุก ูุณุฎุฉ ุงุญุชูุงุทูุฉ"""
    print("\n๐พ ุฅูุดุงุก ูุณุฎุฉ ุงุญุชูุงุทูุฉ...")
    
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
    backup_path = f"backup_ููุธููุฉ_ุงููููุฏุณ_v3_{timestamp}.sql"
    
    if ูุธุงู.ุงูุดุงุก_ูุณุฎุฉ_ุงุญุชูุงุทูุฉ(backup_path):
        print(f"โ ุชู ุฅูุดุงุก ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ: {backup_path}")
        
        # ุนุฑุถ ูุนูููุงุช ุงูููู
        if os.path.exists(backup_path):
            file_size = os.path.getsize(backup_path)
            print(f"   ุญุฌู ุงูููู: {file_size:,} ุจุงูุช ({file_size/1024/1024:.2f} ููุฌุงุจุงูุช)")
    else:
        print("โ ูุดู ูู ุฅูุดุงุก ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ")

def ุงุฎุชุจุงุฑ_ุงูุงุชุตุงู(ูุธุงู):
    """ุงุฎุชุจุงุฑ ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช"""
    print("\n๐ ุงุฎุชุจุงุฑ ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช...")
    
    if ูุธุงู.ุงูุดุงุก_ุงุชุตุงู():
        print("โ ุชู ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช ุจูุฌุงุญ")
        
        # ุงุฎุชุจุงุฑ ุงุณุชุนูุงู ุจุณูุท
        try:
            result = ูุธุงู.ุชูููุฐ_ุงุณุชุนูุงู("SELECT VERSION() as version", fetch=True)
            if result:
                print(f"   ุฅุตุฏุงุฑ MySQL: {result[0][0]}")
            
            # ุงุฎุชุจุงุฑ ูุงุนุฏุฉ ุงูุจูุงูุงุช
            result = ูุธุงู.ุชูููุฐ_ุงุณุชุนูุงู("SELECT DATABASE() as db_name", fetch=True)
            if result:
                print(f"   ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุญุงููุฉ: {result[0][0] or 'ุบูุฑ ูุญุฏุฏุฉ'}")
                
        except Exception as e:
            print(f"โ๏ธ  ุชุญุฐูุฑ: {e}")
            
    else:
        print("โ ูุดู ูู ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช")
        print("๐ก ุชุฃูุฏ ูู:")
        print("   - ุชุดุบูู ุฎุงุฏู MySQL")
        print("   - ุตุญุฉ ุจูุงูุงุช ุงูุงุชุตุงู (ุงููุถููุ ุงููุณุชุฎุฏูุ ูููุฉ ุงููุฑูุฑ)")
        print("   - ูุฌูุฏ ุตูุงุญูุงุช ูุงููุฉ ูููุณุชุฎุฏู")

def ุนุฑุถ_ุงูุฌุฏุงูู_ุงูููุดุฃุฉ(ูุธุงู):
    """ุนุฑุถ ุงูุฌุฏุงูู ุงูููุดุฃุฉ"""
    print("\n๐ ุงูุฌุฏุงูู ุงูููุดุฃุฉ ูู ุงููุธุงู:")
    
    if not ูุธุงู.tables_created:
        print("โ ูุง ุชูุฌุฏ ุฌุฏุงูู ููุดุฃุฉ")
        print("๐ก ูุฑุฌู ุฅูุดุงุก ุงููุธุงู ุงููุงูู ุฃููุงู")
        return
    
    print(f"๐ ุฅุฌูุงูู ุงูุฌุฏุงูู: {len(ูุธุงู.tables_created)}")
    print("-" * 50)
    
    # ุชุฌููุน ุงูุฌุฏุงูู ุญุณุจ ุงูููุน
    table_groups = {
        'ุงููุธุงู': [],
        'ุงููุญุงุณุจุฉ': [],
        'ุงููุดุงุฑูุน': [],
        'ุงูุนููุงุก': [],
        'ุงูููุธููู': [],
        'ุงูุชุฏุฑูุจ': [],
        'ุฃุฎุฑู': []
    }
    
    for table in sorted(ูุธุงู.tables_created):
        if any(keyword in table for keyword in ['ุฅุนุฏุงุฏุงุช', 'ูุณุชุฎุฏููู', 'ุชุตูููุงุช', 'ุณุฌูุงุช', 'ูุฑููุงุช']):
            table_groups['ุงููุธุงู'].append(table)
        elif any(keyword in table for keyword in ['ุญุณุงุจุงุช', 'ูููุฏ', 'ูุฑุงูุฒ_ุงูุชูููุฉ', 'ุณููุงุช_ูุงููุฉ']):
            table_groups['ุงููุญุงุณุจุฉ'].append(table)
        elif any(keyword in table for keyword in ['ูุดุงุฑูุน', 'ูุฑุงุญู', 'ููุงู_ูุฑูู', 'ุนูุฏ_ูุงููุฉ']):
            table_groups['ุงููุดุงุฑูุน'].append(table)
        elif any(keyword in table for keyword in ['ุนููุงุก', 'ูุนุงููุงุช_ุงูุนููุงุก']):
            table_groups['ุงูุนููุงุก'].append(table)
        elif any(keyword in table for keyword in ['ููุธููู', 'ุญุถูุฑ', 'ุชูููู', 'ูุนุงููุงุช_ุงูููุธููู']):
            table_groups['ุงูููุธููู'].append(table)
        elif any(keyword in table for keyword in ['ุชุฏุฑูุจ', 'ุจุฑุงูุฌ', 'ูุฌููุนุงุช', 'ูุฏุฑุจูู', 'ุดูุงุฏุงุช']):
            table_groups['ุงูุชุฏุฑูุจ'].append(table)
        else:
            table_groups['ุฃุฎุฑู'].append(table)
    
    for group_name, tables in table_groups.items():
        if tables:
            print(f"\n๐น {group_name} ({len(tables)} ุฌุฏูู):")
            for i, table in enumerate(tables, 1):
                print(f"   {i:2d}. {table}")

def ุญุณุงุจ_ุฑุตูุฏ_ุญุณุงุจ(ูุธุงู):
    """ุญุณุงุจ ุฑุตูุฏ ุญุณุงุจ"""
    print("\n๐ฐ ุญุณุงุจ ุฑุตูุฏ ุญุณุงุจ...")
    
    # ุนุฑุถ ุงูุญุณุงุจุงุช ุงููุชุงุญุฉ
    accounts = ูุธุงู.ุชุญููู_ุจูุงูุงุช(
        'ุดุฌุฑุฉ_ุงูุญุณุงุจุงุช', 
        'id, ุฑูู_ุงูุญุณุงุจ, ุงุณู_ุงูุญุณุงุจ, ุทุจูุนุฉ_ุงูุญุณุงุจ', 
        'ููุจู_ูููุฏ = TRUE',
        limit=10
    )
    
    if not accounts:
        print("โ ูุง ุชูุฌุฏ ุญุณุงุจุงุช ูุชุงุญุฉ")
        return
    
    print("\n๐ ุงูุญุณุงุจุงุช ุงููุชุงุญุฉ:")
    for i, account in enumerate(accounts, 1):
        print(f"   {i}. {account['ุฑูู_ุงูุญุณุงุจ']} - {account['ุงุณู_ุงูุญุณุงุจ']} ({account['ุทุจูุนุฉ_ุงูุญุณุงุจ']})")
    
    try:
        choice = input("\nุงุฎุชุฑ ุฑูู ุงูุญุณุงุจ (ุฃู ุงุถุบุท Enter ููุฎุฑูุฌ): ").strip()
        if not choice:
            return
        
        choice_idx = int(choice) - 1
        if 0 <= choice_idx < len(accounts):
            account = accounts[choice_idx]
            account_id = account['id']
            
            print(f"\n๐ ุญุณุงุจ ุฑุตูุฏ ุงูุญุณุงุจ: {account['ุงุณู_ุงูุญุณุงุจ']}")
            
            balance = ูุธุงู.ุญุณุงุจ_ุฑุตูุฏ_ุญุณุงุจ(account_id)
            
            print(f"๐ฐ ุงูุฑุตูุฏ ุงูุญุงูู: {balance:,.2f}")
            print(f"๐ท๏ธ  ุทุจูุนุฉ ุงูุญุณุงุจ: {account['ุทุจูุนุฉ_ุงูุญุณุงุจ']}")
            
        else:
            print("โ ุงุฎุชูุงุฑ ุบูุฑ ุตุญูุญ")
            
    except ValueError:
        print("โ ูุฑุฌู ุฅุฏุฎุงู ุฑูู ุตุญูุญ")
    except Exception as e:
        print(f"โ ุฎุทุฃ: {e}")

def ุงุถุงูุฉ_ุจูุงูุงุช_ุชุฌุฑูุจูุฉ(ูุธุงู):
    """ุฅุถุงูุฉ ุจูุงูุงุช ุชุฌุฑูุจูุฉ ูููุธุงู"""
    print("\n๐งช ุฅุถุงูุฉ ุจูุงูุงุช ุชุฌุฑูุจูุฉ...")
    
    try:
        # ุฅุถุงูุฉ ุนููู ุชุฌุฑูุจู
        client_id = ูุธุงู.ุงุฏุฑุงุฌ_ุจูุงูุงุช('ุงูุนููุงุก', {
            'ุฑูู_ุงูุนููู': 'C001',
            'ุงุณู_ุงูุนููู': 'ุดุฑูุฉ ุงูุฑูุงุถ ููุชุทููุฑ',
            'ููุน_ุงูุนููู': 'ุดุฑูุฉ',
            'ุฑูู_ุงููููุฉ_ุงูุณุฌู': '1234567890',
            'ุงูุนููุงู': 'ุงูุฑูุงุถุ ุญู ุงูููู ููุฏ',
            'ุฑูู_ุงููุงุชู': '011-1234567',
            'ุงูุจุฑูุฏ_ุงูุฅููุชุฑููู': 'info@riyadh-dev.com',
            'ุฑุตูุฏ_ุงูุนููู': 0,
            'ุงูุญุงูุฉ': 'ูุดุท',
            'ุงููุณุชุฎุฏู': 'admin'
        })
        
        if client_id:
            print(f"โ ุชู ุฅุถุงูุฉ ุนููู ุชุฌุฑูุจู - ุงููุนุฑู: {client_id}")
        
        # ุฅุถุงูุฉ ููุธู ุชุฌุฑูุจู
        employee_id = ูุธุงู.ุงุฏุฑุงุฌ_ุจูุงูุงุช('ุงูููุธููู', {
            'ุฑูู_ุงูููุธู': 'E001',
            'ุงุณู_ุงูููุธู': 'ุฃุญูุฏ ูุญูุฏ ุงูุณุนูุฏ',
            'ุฑูู_ุงููููุฉ': '1234567890',
            'ุงููุธููุฉ': 'ูููุฏุณ ูุดุงุฑูุน',
            'ุงููุณู': 'ุงูููุฏุณุฉ',
            'ุชุงุฑูุฎ_ุงูุชูุธูู': '2024-01-01',
            'ุงููุฑุชุจ_ุงูุฃุณุงุณู': 8000,
            'ุงูุญุงูุฉ': 'ูุดุท',
            'ุงููุณุชุฎุฏู': 'admin'
        })
        
        if employee_id:
            print(f"โ ุชู ุฅุถุงูุฉ ููุธู ุชุฌุฑูุจู - ุงููุนุฑู: {employee_id}")
        
        # ุฅุถุงูุฉ ููุฑุฏ ุชุฌุฑูุจู
        supplier_id = ูุธุงู.ุงุฏุฑุงุฌ_ุจูุงูุงุช('ุงูููุฑุฏูู', {
            'ุฑูู_ุงูููุฑุฏ': 'S001',
            'ุงุณู_ุงูููุฑุฏ': 'ุดุฑูุฉ ููุงุฏ ุงูุจูุงุก ุงููุชูุฏูุฉ',
            'ููุน_ุงูููุฑุฏ': 'ุดุฑูุฉ',
            'ุฑูู_ุงูุณุฌู_ุงูุชุฌุงุฑู': '1234567890',
            'ุงูุนููุงู': 'ุงูุฑูุงุถุ ุงูููุทูุฉ ุงูุตูุงุนูุฉ',
            'ุฑูู_ุงููุงุชู': '011-9876543',
            'ุงูุจุฑูุฏ_ุงูุฅููุชุฑููู': 'sales@advanced-materials.com',
            'ููุน_ุงููุดุงุท': 'ููุงุฏ ุจูุงุก',
            'ุงูุญุงูุฉ': 'ูุดุท',
            'ุงููุณุชุฎุฏู': 'admin'
        })
        
        if supplier_id:
            print(f"โ ุชู ุฅุถุงูุฉ ููุฑุฏ ุชุฌุฑูุจู - ุงููุนุฑู: {supplier_id}")
        
        # ุฅุถุงูุฉ ูุดุฑูุน ุชุฌุฑูุจู
        if client_id and employee_id:
            project_id = ูุธุงู.ุงุฏุฑุงุฌ_ุจูุงูุงุช('ุงููุดุงุฑูุน', {
                'ุฑูู_ุงููุดุฑูุน': 'P001',
                'ูุนุฑู_ุงูุนููู': client_id,
                'ูุนุฑู_ุงููุฏูุฑ': employee_id,
                'ุงุณู_ุงููุดุฑูุน': 'ูุฌูุน ุณููู - ุญู ุงููุฑุฌุณ',
                'ุงููุตู': 'ุฅูุดุงุก ูุฌูุน ุณููู ูุชูุงูู',
                'ุงููููุน': 'ุงูุฑูุงุถุ ุญู ุงููุฑุฌุณ',
                'ุงููุณุงุญุฉ': 5000,
                'ูููุฉ_ุงููุดุฑูุน': 2500000,
                'ุชุงุฑูุฎ_ุงูุจุฏุงูุฉ': '2024-01-15',
                'ุชุงุฑูุฎ_ุงูููุงูุฉ_ุงููุฎุทุท': '2024-12-31',
                'ุงูุญุงูุฉ': 'ููุฏ_ุงูุชูููุฐ',
                'ุงููุณุชุฎุฏู': 'admin'
            })
            
            if project_id:
                print(f"โ ุชู ุฅุถุงูุฉ ูุดุฑูุน ุชุฌุฑูุจู - ุงููุนุฑู: {project_id}")
        
        print("\n๐ ุชู ุฅุถุงูุฉ ุงูุจูุงูุงุช ุงูุชุฌุฑูุจูุฉ ุจูุฌุงุญ!")
        
    except Exception as e:
        print(f"โ ุฎุทุฃ ูู ุฅุถุงูุฉ ุงูุจูุงูุงุช ุงูุชุฌุฑูุจูุฉ: {e}")

def main():
    """ุงูุฏุงูุฉ ุงูุฑุฆูุณูุฉ"""
    print("๐ ุฌุงุฑู ุชููุฆุฉ ุงููุธุงู ุงููุญุงุณุจู...")
    
    # ุฅูุดุงุก ูุซูู ูู ุงููุธุงู
    ูุธุงู = ูุธุงู_ุงููุญุงุณุจุฉ_ุงูุดุงูู()
    
    try:
        while True:
            ุนุฑุถ_ุงููุงุฆูุฉ_ุงูุฑุฆูุณูุฉ()
            
            choice = input("\n๐ ุงุฎุชุฑ ุงูุนูููุฉ ุงููุทููุจุฉ: ").strip()
            
            if choice == '1':
                ุงูุดุงุก_ุงููุธุงู_ุงููุงูู(ูุธุงู)
            elif choice == '2':
                ุนุฑุถ_ุงุญุตุงุฆูุงุช_ุงููุธุงู(ูุธุงู)
            elif choice == '3':
                ุงูุดุงุก_ููุฏ_ุชุฌุฑูุจู(ูุธุงู)
            elif choice == '4':
                ุงูุดุงุก_ูุณุฎุฉ_ุงุญุชูุงุทูุฉ(ูุธุงู)
            elif choice == '5':
                ุงุฎุชุจุงุฑ_ุงูุงุชุตุงู(ูุธุงู)
            elif choice == '6':
                ุนุฑุถ_ุงูุฌุฏุงูู_ุงูููุดุฃุฉ(ูุธุงู)
            elif choice == '7':
                ุญุณุงุจ_ุฑุตูุฏ_ุญุณุงุจ(ูุธุงู)
            elif choice == '8':
                ุงุถุงูุฉ_ุจูุงูุงุช_ุชุฌุฑูุจูุฉ(ูุธุงู)
            elif choice == '0':
                print("\n๐ ุดูุฑุงู ูุงุณุชุฎุฏุงู ููุธููุฉ ุงููููุฏุณ v3")
                break
            else:
                print("\nโ ุงุฎุชูุงุฑ ุบูุฑ ุตุญูุญุ ูุฑุฌู ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู")
            
            input("\nโธ๏ธ  ุงุถุบุท Enter ูููุชุงุจุนุฉ...")
    
    except KeyboardInterrupt:
        print("\n\nโ๏ธ  ุชู ุฅููุงู ุงูุจุฑูุงูุฌ ุจูุงุณุทุฉ ุงููุณุชุฎุฏู")
    
    except Exception as e:
        print(f"\nโ ุฎุทุฃ ุบูุฑ ูุชููุน: {e}")
    
    finally:
        ูุธุงู.ุงุบูุงู_ุงุชุตุงู()
        print("๐ ุชู ุฅุบูุงู ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช")

if __name__ == "__main__":
    main()